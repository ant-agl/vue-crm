"use strict";(self["webpackChunkVueCRM"]=self["webpackChunkVueCRM"]||[]).push([[585],{4585:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var o=r(3396),i=r(7139);const c=e=>((0,o.dD)("data-v-9bc9586c"),e=e(),(0,o.Cn)(),e),s={class:"page-title"},n=c((()=>(0,o._)("h3",null,"Планирование",-1))),l={key:1,class:"center"},a={key:2},g={key:0},u=c((()=>(0,o._)("h5",null,"Расходы",-1))),d={key:1},h={key:2},p=c((()=>(0,o._)("h5",null,"Доходы",-1)));function y(e,t,r,c,y,w){const f=(0,o.up)("AppLoader"),m=(0,o.up)("router-link"),k=(0,o.up)("PlanningRow");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",s,[n,(0,o._)("h4",null,(0,i.zw)(e.$filters.currency(e.info.bill)),1)]),e.loading?((0,o.wg)(),(0,o.j4)(f,{key:0})):0==e.categories.length?((0,o.wg)(),(0,o.iD)("p",l,[(0,o.Uk)(" Категорий пока нет. "),(0,o.Wm)(m,{to:"/categories"},{default:(0,o.w5)((()=>[(0,o.Uk)("Создать новую категорию")])),_:1})])):((0,o.wg)(),(0,o.iD)("section",a,[w.categoriesOutcome.length?((0,o.wg)(),(0,o.iD)("div",g,[u,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(w.categoriesOutcome,(e=>((0,o.wg)(),(0,o.j4)(k,{key:e.id,category:e},null,8,["category"])))),128))])):(0,o.kq)("",!0),w.categoriesOutcome.length&&w.categoriesIncome.length?((0,o.wg)(),(0,o.iD)("hr",d)):(0,o.kq)("",!0),w.categoriesIncome.length?((0,o.wg)(),(0,o.iD)("div",h,[p,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(w.categoriesIncome,(e=>((0,o.wg)(),(0,o.j4)(k,{key:e.id,category:e},null,8,["category"])))),128))])):(0,o.kq)("",!0)]))])}r(7658);const w={class:"progress"};function f(e,t,r,c,s,n){const l=(0,o.Q2)("tooltipe");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("p",null,[(0,o._)("strong",null,(0,i.zw)(r.category.title)+":",1),(0,o.Uk)(" "+(0,i.zw)(e.$filters.currency(r.category.spend))+" из "+(0,i.zw)(e.$filters.currency(r.category.limit)),1)]),(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("div",{class:(0,i.C_)(["determinate",[r.category.progressColor]]),style:(0,i.j5)({width:r.category.progressPercent+"%"})},null,6)])),[[l,r.category.tooltipeText]])])}var m={props:{category:Object}},k=r(89);const v=(0,k.Z)(m,[["render",f]]);var _=v,D=r(65),$={components:{PlanningRow:_},data:()=>({loading:!0}),computed:{...(0,D.Se)(["info","categories","records"]),categoriesOutcome(){let e=[];return this.categories.filter((e=>"outcome"===e.type)).forEach((t=>{const r=this.records.filter((e=>e.categoryId===t.id)).reduce(((e,t)=>e+t.sum),0),o=r/t.limit*100,i=o<60?"green":o<95?"orange":"red",c=t.limit-r,s=`${c>0?"Осталось":"Превышение на"} ${this.$filters.currency(Math.abs(c))}`;e.push({...t,spend:r,progressColor:i,progressPercent:o,tooltipeText:s})})),e},categoriesIncome(){let e=[];return this.categories.filter((e=>"income"===e.type)).forEach((t=>{const r=this.records.filter((e=>e.categoryId===t.id)).reduce(((e,t)=>e+t.sum),0),o=r/t.limit*100,i="green",c=t.limit-r,s=`${c>0?"Еще планируется получить":"Вы получили больше на"} ${this.$filters.currency(Math.abs(c))}`;e.push({...t,spend:r,progressColor:i,progressPercent:o,tooltipeText:s})})),e}},async mounted(){this.records.length||await this.$store.dispatch("fetchRecords"),this.categories.length||await this.$store.dispatch("fetchCategories"),this.loading=!1}};const C=(0,k.Z)($,[["render",y],["__scopeId","data-v-9bc9586c"]]);var b=C}}]);
//# sourceMappingURL=585.32b9e86b.js.map