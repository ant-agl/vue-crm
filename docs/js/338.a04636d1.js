"use strict";(self["webpackChunkVueCRM"]=self["webpackChunkVueCRM"]||[]).push([[338],{2338:function(e,t,i){i.r(t),i.d(t,{default:function(){return O}});var l=i(3396);const s=(0,l._)("div",{class:"page-title"},[(0,l._)("h3",null,"Категории")],-1),n={key:1,class:"row"},a={key:1,class:"center"};function r(e,t,i,r,o,u){const d=(0,l.up)("AppLoader"),c=(0,l.up)("CategoryCreate"),p=(0,l.up)("CategoryEdit");return(0,l.wg)(),(0,l.iD)("div",null,[s,(0,l._)("section",null,[e.loading?((0,l.wg)(),(0,l.j4)(d,{key:0})):((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(c),u.categoriesLength>0?((0,l.wg)(),(0,l.j4)(p,{key:0})):((0,l.wg)(),(0,l.iD)("p",a,"Категорий пока нет"))]))])])}var o=i(9242),u=i(7139);const d={class:"col s12 m6"},c=(0,l._)("div",{class:"page-subtitle"},[(0,l._)("h4",null,"Создать")],-1),p={class:"input-field"},m=(0,l._)("label",{for:"name"},"Название",-1),h={key:0,class:"helper-text invalid"},v={class:"input-field"},g=(0,l._)("label",{for:"limit"},"Лимит",-1),y={key:0,class:"helper-text invalid"},_=(0,l._)("span",null,"Расходная категория",-1),$=(0,l._)("span",null,"Доходная категория",-1),w=(0,l._)("button",{class:"btn waves-effect waves-light",type:"submit"},[(0,l.Uk)(" Создать "),(0,l._)("i",{class:"material-icons right"},"send")],-1);function f(e,t,i,s,n,a){return(0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",null,[c,(0,l._)("form",{onSubmit:t[4]||(t[4]=(0,o.iM)(((...e)=>a.sendForm&&a.sendForm(...e)),["prevent"]))},[(0,l._)("div",p,[(0,l.wy)((0,l._)("input",{id:"name",type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.title=t),class:(0,u.C_)({invalid:e.v$.title.$error})},null,2),[[o.nr,e.title]]),m,e.v$.title.$error?((0,l.wg)(),(0,l.iD)("span",h," Введите название ")):(0,l.kq)("",!0)]),(0,l._)("div",v,[(0,l.wy)((0,l._)("input",{id:"limit",type:"number","onUpdate:modelValue":t[1]||(t[1]=t=>e.limit=t),class:(0,u.C_)({invalid:e.v$.limit.$error})},null,2),[[o.nr,e.limit,void 0,{number:!0}]]),g,e.v$.limit.$error?((0,l.wg)(),(0,l.iD)("span",y," Минимальное значение "+(0,u.zw)(e.v$.limit.minValue.$params.min),1)):(0,l.kq)("",!0)]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{class:"with-gap",name:"type",type:"radio",value:"outcome","onUpdate:modelValue":t[2]||(t[2]=t=>e.type=t)},null,512),[[o.G2,e.type]]),_])]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{class:"with-gap",name:"type",type:"radio",value:"income","onUpdate:modelValue":t[3]||(t[3]=t=>e.type=t)},null,512),[[o.G2,e.type]]),$])]),w],32)])])}var b=i(5778),C=i.n(b),k=i(4219),V=i(5420),U={setup:()=>({v$:(0,k.Xw)()}),data:()=>({title:"",limit:100,type:"outcome"}),validations:()=>({title:{required:V.C1},limit:{required:V.C1,minValue:(0,V.uv)(100)}}),mounted(){C().updateTextFields()},methods:{sendForm(){if(this.v$.$invalid)return this.v$.$touch(),!1;const e={title:this.title,limit:this.limit,type:this.type};this.$store.dispatch("createCategory",e).then((e=>{e&&(this.v$.$reset(),this.title="",this.limit=100,this.type="outcome",this.$message("Категория была создана"))}))}}},D=i(89);const F=(0,D.Z)(U,[["render",f]]);var x=F;const q={class:"col s12 m6"},M=(0,l._)("div",{class:"page-subtitle"},[(0,l._)("h4",null,"Редактировать")],-1),G={class:"input-field"},L=["value"],S=(0,l._)("label",null,"Выберите категорию",-1),z={class:"input-field"},T=(0,l._)("label",{for:"name"},"Название",-1),Z={key:0,class:"helper-text invalid"},j={class:"input-field"},E=(0,l._)("label",{for:"limit"},"Лимит",-1),R={key:0,class:"helper-text invalid"},X=(0,l._)("span",null,"Расходная категория",-1),A=(0,l._)("span",null,"Доходная категория",-1),H=(0,l._)("button",{class:"btn waves-effect waves-light",type:"submit"},[(0,l.Uk)(" Обновить "),(0,l._)("i",{class:"material-icons right"},"create")],-1),K=(0,l._)("i",{class:"material-icons right"},"delete",-1);function W(e,t,i,s,n,a){return(0,l.wg)(),(0,l.iD)("div",q,[(0,l._)("div",null,[M,(0,l._)("form",{onSubmit:t[6]||(t[6]=(0,o.iM)(((...e)=>a.sendForm&&a.sendForm(...e)),["prevent"]))},[(0,l._)("div",G,[(0,l.wy)((0,l._)("select",{ref:"select","onUpdate:modelValue":t[0]||(t[0]=t=>e.current=t)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.categories,(e=>((0,l.wg)(),(0,l.iD)("option",{key:e.id,value:e.id},(0,u.zw)(e.title),9,L)))),128))],512),[[o.bM,e.current]]),S]),(0,l._)("div",z,[(0,l.wy)((0,l._)("input",{id:"name",type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.title=t),class:(0,u.C_)({invalid:e.v$.title.$error})},null,2),[[o.nr,e.title]]),T,e.v$.title.$error?((0,l.wg)(),(0,l.iD)("span",Z," Введите название ")):(0,l.kq)("",!0)]),(0,l._)("div",j,[(0,l.wy)((0,l._)("input",{id:"limit",type:"number","onUpdate:modelValue":t[2]||(t[2]=t=>e.limit=t),class:(0,u.C_)({invalid:e.v$.limit.$error})},null,2),[[o.nr,e.limit,void 0,{number:!0}]]),E,e.v$.limit.$error?((0,l.wg)(),(0,l.iD)("span",R," Минимальное значение "+(0,u.zw)(e.v$.limit.minValue.$params.min),1)):(0,l.kq)("",!0)]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{class:"with-gap",name:"type",type:"radio",value:"outcome","onUpdate:modelValue":t[3]||(t[3]=t=>e.type=t)},null,512),[[o.G2,e.type]]),X])]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.wy)((0,l._)("input",{class:"with-gap",name:"type",type:"radio",value:"income","onUpdate:modelValue":t[4]||(t[4]=t=>e.type=t)},null,512),[[o.G2,e.type]]),A])]),H,(0,l._)("button",{class:"btn waves-effect waves-light btn-delete",onClick:t[5]||(t[5]=(0,o.iM)(((...e)=>a.deleteCategory&&a.deleteCategory(...e)),["prevent"]))},[(0,l.Uk)(" Удалить "),K])],32)])])}var Y={setup:()=>({v$:(0,k.Xw)()}),data:()=>({select:null,current:null,title:"",limit:100,type:"outcome"}),validations:()=>({title:{required:V.C1},limit:{required:V.C1,minValue:(0,V.uv)(100)}}),computed:{categories(){return this.$store.getters.categories}},watch:{categories:{handler(){this.select=C().FormSelect.init(this.$refs.select)},flush:"post"},current(e){const{title:t,limit:i,type:l}=this.categories.find((t=>t.id===e));this.title=t,this.limit=i,this.type=l,C().updateTextFields()}},created(){if(this.categories.length){const{id:e,title:t,limit:i,type:l}=this.categories[0];this.current=e,this.title=t,this.limit=i,this.type=l}},mounted(){this.select=C().FormSelect.init(this.$refs.select),C().updateTextFields()},unmounted(){this.select?.destroy&&this.select.destroy()},methods:{sendForm(){if(this.v$.$invalid)return this.v$.$touch(),!1;const e={id:this.current,title:this.title,limit:this.limit,type:this.type};this.$store.dispatch("updateCategory",e).then((e=>{e&&this.$message("Категория обновлена")}))},deleteCategory(){this.$store.dispatch("deleteCategory",{id:this.current}).then((e=>{e&&(this.$message("Категория удалена"),this.categories.length?this.current=this.categories[0].id:this.current=null)}))}}};const B=(0,D.Z)(Y,[["render",W]]);var I=B,J={components:{CategoryCreate:x,CategoryEdit:I},data:()=>({loading:!0}),computed:{categoriesLength(){return this.$store.getters.categories.length}},mounted(){this.categoriesLength?this.loading=!1:this.$store.dispatch("fetchCategories").then((()=>{this.loading=!1}))}};const N=(0,D.Z)(J,[["render",r]]);var O=N}}]);
//# sourceMappingURL=338.a04636d1.js.map