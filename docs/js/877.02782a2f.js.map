{"version":3,"file":"js/877.02782a2f.js","mappings":"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","sources":["webpack://VueCRM/./src/views/RecordView.vue","webpack://VueCRM/./src/views/RecordView.vue?5489"],"sourcesContent":["<template>\n  <div>\n    <div class=\"page-title\">\n      <h3>Новая запись</h3>\n    </div>\n\n    <AppLoader v-if=\"loading\" />\n    <p v-else-if=\"categories.length == 0\" class=\"center\">\n      Категорий пока нет.\n      <router-link to=\"/categories\">Создать новую категорию</router-link>\n    </p>\n    <form v-else class=\"form\" @submit.prevent=\"sendForm\">\n      <p v-if=\"hasCatOutcome\">\n        <label>\n          <input\n            class=\"with-gap\"\n            name=\"type\"\n            type=\"radio\"\n            value=\"outcome\"\n            v-model=\"type\"\n          />\n          <span>Расход</span>\n        </label>\n      </p>\n      <p v-if=\"hasCatIncome\">\n        <label>\n          <input\n            class=\"with-gap\"\n            name=\"type\"\n            type=\"radio\"\n            value=\"income\"\n            v-model=\"type\"\n          />\n          <span>Доход</span>\n        </label>\n      </p>\n      <br />\n\n      <div class=\"input-field\">\n        <select ref=\"select\" v-model=\"current\">\n          <option v-for=\"cat in filterCategories\" :key=\"cat.id\" :value=\"cat.id\">\n            {{ cat.title }}\n          </option>\n        </select>\n        <label>Выберите категорию</label>\n      </div>\n\n      <div class=\"input-field\">\n        <input\n          id=\"amount\"\n          type=\"number\"\n          v-model.number=\"sum\"\n          :class=\"{ invalid: v$.sum.$error }\"\n        />\n        <label for=\"amount\">Сумма</label>\n        <span class=\"helper-text invalid\" v-if=\"v$.sum.$error\">\n          Минимальное значение {{ v$.sum.minValue.$params.min }}\n        </span>\n      </div>\n\n      <div class=\"input-field\">\n        <input\n          id=\"description\"\n          type=\"text\"\n          v-model=\"desc\"\n          :class=\"{ invalid: v$.desc.$error }\"\n        />\n        <label for=\"description\">Описание</label>\n        <span class=\"helper-text invalid\" v-if=\"v$.desc.$error\">\n          Обязательное поле\n        </span>\n      </div>\n\n      <button class=\"btn waves-effect waves-light\" type=\"submit\">\n        Создать\n        <i class=\"material-icons right\">send</i>\n      </button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport M from \"materialize-css/dist/js/materialize.min\";\nimport { useVuelidate } from \"@vuelidate/core\";\nimport { required, minValue } from \"@vuelidate/validators\";\nimport { mapGetters } from \"vuex\";\n\nexport default {\n  setup: () => ({\n    v$: useVuelidate(),\n  }),\n  data: () => ({\n    loading: true,\n    select: null,\n    sum: \"\",\n    desc: \"\",\n    type: \"outcome\",\n    current: null,\n  }),\n  computed: {\n    ...mapGetters([\"info\", \"categories\"]),\n    filterCategories() {\n      return this.categories.filter((c) => c.type === this.type);\n    },\n    hasCatIncome() {\n      return this.categories.some((c) => c.type === \"income\");\n    },\n    hasCatOutcome() {\n      return this.categories.some((c) => c.type === \"outcome\");\n    },\n  },\n  watch: {\n    filterCategories() {\n      this.current = this.filterCategories?.[0].id;\n      setTimeout(() => {\n        this.select = M.FormSelect.init(this.$refs.select);\n      });\n    },\n  },\n  async mounted() {\n    if (!this.categories.length) {\n      await this.$store.dispatch(\"fetchCategories\");\n    }\n    this.loading = false;\n    setTimeout(() => {\n      this.type = this.hasCatOutcome ? \"outcome\" : \"income\";\n      this.current = this.filterCategories?.[0]?.id ?? null;\n      setTimeout(() => {\n        this.select = M.FormSelect.init(this.$refs.select);\n      });\n    });\n  },\n  unmounted() {\n    if (this.select?.destroy) this.select.destroy();\n  },\n  validations: () => ({\n    current: { required },\n    sum: { required, minValue: minValue(0) },\n    desc: { required },\n  }),\n  methods: {\n    sendForm() {\n      if (this.v$.$invalid) {\n        this.v$.$touch();\n        return;\n      }\n\n      const formData = {\n        categoryId: this.current,\n        sum: this.sum,\n        desc: this.desc,\n        type: this.type,\n        date: new Date().toJSON(),\n      };\n\n      this.$store.dispatch(\"createRecord\", formData).then((success) => {\n        if (!success) return;\n\n        const bill =\n          this.type == \"income\"\n            ? this.info.bill + this.sum\n            : this.info.bill - this.sum;\n        this.info.bill = bill;\n        this.$store.dispatch(\"updateInfo\", { bill });\n\n        this.v$.$reset();\n        this.$message(\"Запись добавлена\");\n        this.sum = \"\";\n        this.desc = \"\";\n      });\n    },\n  },\n};\n</script>\n","import { render } from \"./RecordView.vue?vue&type=template&id=b0602226\"\nimport script from \"./RecordView.vue?vue&type=script&lang=js\"\nexport * from \"./RecordView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/antonaglushevich/Documents/learn/vue/vue-crm/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","for","type","_createElementBlock","_hoisted_1","_ctx","loading","_createBlock","_component_AppLoader","key","categories","length","_hoisted_2","_createVNode","_component_router_link","to","onSubmit","_cache","_withModifiers","args","$options","sendForm","hasCatOutcome","_hoisted_3","name","value","$event","_hoisted_4","hasCatIncome","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","ref","current","_Fragment","_renderList","filterCategories","cat","id","title","_hoisted_9","_hoisted_10","_hoisted_11","sum","_normalizeClass","invalid","v$","$error","_hoisted_12","_hoisted_13","_toDisplayString","minValue","$params","min","_hoisted_14","desc","_hoisted_15","_hoisted_16","_hoisted_17","setup","useVuelidate","data","select","computed","mapGetters","this","filter","c","some","watch","setTimeout","M","$refs","async","$store","dispatch","unmounted","destroy","validations","required","methods","$invalid","$touch","formData","categoryId","date","Date","toJSON","then","success","bill","info","$reset","$message","__exports__","render"],"sourceRoot":""}